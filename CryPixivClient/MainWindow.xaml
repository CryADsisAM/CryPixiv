<Window x:Class="CryPixivClient.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:CryPixivClient.ViewModels"
        xmlns:local="clr-namespace:CryPixivClient"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        mc:Ignorable="d" MinHeight="350" MinWidth="525" Height="350" Width="525" Icon="Images/pixiv.ico" Closing="Window_Closing" SizeChanged="Window_SizeChanged" StateChanged="Window_StateChanged">
    <Window.Resources>
        <vm:MainViewModel x:Key="mainViewModel"/>
        <BitmapImage x:Key="missingImage" UriSource="Images/missingImage.jpg" />
        <CollectionViewSource x:Key="ItemListViewSource" Source="{Binding FoundWorks, Source={StaticResource mainViewModel}}"/>
    </Window.Resources>
    <Window.Title>
        <Binding Mode="OneWay" Path="Title" Source="{StaticResource mainViewModel}"/>
    </Window.Title>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="15*"/>
            <ColumnDefinition Width="32*"/>
        </Grid.ColumnDefinitions>
        <ListView x:Name="mainList" Margin="0,76,0,22" ItemsSource="{Binding Mode=OneWay, Source={StaticResource ItemListViewSource}}" Grid.ColumnSpan="2" ScrollViewer.CanContentScroll="False"
                  ScrollViewer.ScrollChanged="mainList_ScrollChanged">
            <ListView.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Columns="{Binding Columns, Mode=OneWay, Source={StaticResource mainViewModel}}" HorizontalAlignment="Center" VerticalAlignment="Top"/>
                </ItemsPanelTemplate>
            </ListView.ItemsPanel>
            <ListView.ItemTemplate>
                <DataTemplate>
                    <StackPanel>
                        <Image Width="128" Height="128" Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality">
                            <Image.Source>
                                <PriorityBinding FallbackValue="{StaticResource missingImage}">
                                    <Binding Path="ImageThumbnail" IsAsync="True"/>
                                </PriorityBinding>
                            </Image.Source>
                        </Image>
                    </StackPanel>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
        <TextBox x:Name="txtSearchQuery" Height="24" Margin="10,14,65,0" TextWrapping="Wrap" VerticalAlignment="Top" FontSize="14" MaxLength="300" MaxLines="1" TabIndex="1"/>
        <Button x:Name="btnSearch" Content="Search" Margin="0,14,10,0" VerticalAlignment="Top" Height="24" BorderBrush="#FFABADB3" HorizontalAlignment="Right" Width="56" IsDefault="True" TabIndex="2" Click="btnSearch_Click"/>
        <ProgressBar x:Name="mainProgessBar" Height="10" Margin="0,67,0,0" VerticalAlignment="Top" Foreground="#FF009CFF" Grid.ColumnSpan="2" IsTabStop="False" 
                     IsIndeterminate="{Binding IsWorking, Source={StaticResource mainViewModel}}"/>
        <Button x:Name="btnBookmarks" Content="Bookmarks" Grid.Column="1" HorizontalAlignment="Left" Margin="260,14,0,0" VerticalAlignment="Top" Width="80" Height="40" TabIndex="5" Click="btnBookmarks_Click"/>
        <Button x:Name="btnDailyRankings" Content="Daily Ranking" Grid.Column="1" HorizontalAlignment="Left" Margin="94,14,0,0" VerticalAlignment="Top" Width="94" Height="40" Background="#FFCAE7FF" Click="btnDailyRankings_Click" TabIndex="3"/>
        <StatusBar Height="22" VerticalAlignment="Bottom" Grid.ColumnSpan="2">
            <StatusBarItem Margin="0,-2,0,0">
                <TextBlock x:Name="txtStatus" Text="{Binding Status, Source={StaticResource mainViewModel}}"></TextBlock>
            </StatusBarItem>
        </StatusBar>
        <Button x:Name="btnFollowing" Content="Following" Grid.Column="1" HorizontalAlignment="Left" Margin="187,14,0,0" VerticalAlignment="Top" Width="74" Height="40" Background="#FFFFF8CA" Click="btnFollowing_Click" TabIndex="4"/>
        <CheckBox x:Name="checkPopular" Content="Autosort by Popularity" HorizontalAlignment="Left" Margin="10,43,0,0" VerticalAlignment="Top" IsChecked="True" Click="checkPopular_Click"/>
        <Button x:Name="btnResults" Content="Results" Grid.Column="1" HorizontalAlignment="Left" Margin="15,14,0,0" VerticalAlignment="Top" Width="80" Height="40" TabIndex="5" Click="btnResults_Click" Background="#FF93C1E8"/>
    </Grid>
</Window>
